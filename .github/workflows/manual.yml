on:
  push:
    branches:
      - main
name: 🚀 Deploy website on push

# env:
#   MONGO: ${{vars.MONGO}}
#   JWT_SECRET_KEY: ${{vars.JWT_SECRET_KEY}}

jobs:
  web-deploy:
    name: 🎉 Deploy
    runs-on: ubuntu-latest
    steps:
      - name: 🚚 Get latest code
        uses: actions/checkout@v3

      - name: 🖥 Use Node.js 21
        uses: actions/setup-node@v2
        with:
          node-version: "21"
      # - name: 🔨 Build Project
      #   run: |
      #     npm install
      #     npm run build

      # - name: 📂 Copy Build Files to the server
      #   uses: appleboy/scp-action@v0.1.7
      #   with:
      #     host: ${{ secrets.HOST }}
      #     username: ${{ secrets.USERNAME }}
      #     password: ${{ secrets.PASSWORD }}
      #     source: ".next"
      #     target: ~/feminvestment/

      - name: ♻️ Restart the server
        uses: appleboy/ssh-action@master
        with:
          # host: ${{ secrets.HOST }}
          # username: ${{ secrets.USERNAME }}
          # password: ${{ secrets.PASSWORD }}
          host: "141.95.126.90"
          username: "feminves"
          password: "RAEts9d[Q52-r6"
          script: |
            cd ~/kaudinya-gotriya &&
            git pull &&
            touch ~/kaudinya-gotriya/tmp/restart.txt
